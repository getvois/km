<script src='/frontend/js/footer.min.js?{{ assets_version() }}'></script>

<script>
    Modernizr.load([
        {
            test: Modernizr.inlinesvg,
            nope: [
                {% stylesheets
                    '@SandboxWebsiteBundle/Resources/public/scss/legacy/fallbacks/no-inlinesvg.scss'
                    filter='scss'
                    output='frontend/no-inlinesvg.css'
                %}
                '{{ asset_url }}'
                {% endstylesheets %}
                ,
                {% javascripts
                    'vendor/svgeezy/svgeezy.js'
                    filter='yui_js'
                    combine=true
                    output='frontend/svgeezy.js'
                %}
                '{{ asset_url }}'
                {% endjavascripts %}
            ],
            callback : function (url, result, key) {
                if(key == 1) {
                    svgeezy.init('png');
                }
            }
        },
        {
            test: Modernizr.input.placeholder,
                {% javascripts
                    'vendor/jquery-placeholder/jquery.placeholder.js'
                    filter='yui_js'
                    combine=true
                    output='frontend/placeholder.js'
                %}
            nope: '{{ asset_url }}',
                {% endjavascripts %}
            callback : function (url, result, key) {
                $('input, textarea').placeholder();
            }
        }
    ]);
</script>

{% if ga_code is defined %}
    <script src='/frontend/js/analytics.min.js?{{ assets_version() }}'></script>
    {{ google_analytics_initialize({'account_id': ga_code}) }}
{% endif %}

<script>
    // This is called with the results from from FB.getLoginStatus().
    function statusChangeCallback(response) {
        //console.log(response);
        // The response object is returned with a status field that lets the
        // app know the current login status of the person.
        // Full docs on the response object can be found in the documentation
        // for FB.getLoginStatus().
        if (response.status === 'connected') {
            // Logged into your app and Facebook.
            fbLogin(response.authResponse.accessToken);
        } else if (response.status === 'not_authorized') {
            // The person is logged into Facebook, but not your app.
        } else {
            // The person is not logged into Facebook, so we're not sure if
            // they are logged into this app or not.
        }
    }

    // This function is called when someone finishes with the Login
    // Button.  See the onlogin handler attached to it in the sample
    // code below.
//    function checkLoginState() {
//        FB.getLoginStatus(function(response) {
//            statusChangeCallback(response);
//        });
//    }

    $("#fb-login-btn").click(function () {
        FB.login(function(response) {
            statusChangeCallback(response);
        }, {
            scope: 'public_profile,email'
        });

        return false;
    });

    window.fbAsyncInit = function() {
        FB.init({
            appId      : {% if host and host.appId %}{{ host.appId }}{% else %}1577226712516009{% endif %},//,//todo kosmos change this
            cookie     : true,  // enable cookies to allow the server to access
                                // the session
            xfbml      : true,  // parse social plugins on this page
            version    : 'v2.2' // use version 2.2
        });

        // Now that we've initialized the JavaScript SDK, we call
        // FB.getLoginStatus().  This function gets the state of the
        // person visiting this page and can return one of three states to
        // the callback you provide.  They can be:
        //
        // 1. Logged into your app ('connected')
        // 2. Logged into Facebook, but not your app ('not_authorized')
        // 3. Not logged into Facebook and can't tell if they are logged into
        //    your app or not.
        //
        // These three cases are handled in the callback function.

//        FB.getLoginStatus(function(response) {
//            statusChangeCallback(response);
//        });

    };

    // Load the SDK asynchronously
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    // Here we run a very simple test of the Graph API after login is
    // successful.  See statusChangeCallback() for when this call is made.
    function fbLogin(token) {
        $.get("/login-fb/" + token, function (responce) {
            if(responce.status == 'error'){
                //show error msg
                alert(responce.msg);
            }else{
                //redirect to front page or just refresh page?
                window.location = window.location;
            }
        })
    }
</script>


<script src="{{ asset('bundles/sandboxwebsite/frontend/js/jquery-ui-1.11.2/jquery-ui.min.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/jquery-ui-1.11.2/ui/i18n/datepicker-' ~ app.request.locale ~ '.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/select2/select2.js') }}"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/spin.min.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/columnizer/jquery.columnizer.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/jquery-multiselect-tree/js/tree_multiselect.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/fancybox/jquery.fancybox.pack.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/fancybox/helpers/jquery.fancybox-thumbs.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/dataholder.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/underscore-min.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/calendar/language/' ~ app.request.locale ~ '.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/calendar/calendar.js') }}"></script>

<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/datepick/jquery.plugin.js') }}"></script>
<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/datepick/jquery.datepick.js') }}"></script>
<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/datepick/jquery.datepick-' ~ app.request.locale ~ '.js') }}"></script>

<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/jstree/jstree.js') }}"></script>
<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/jstree/jstree.checkbox.js') }}"></script>

<script type="text/javascript" src="{{ asset('bundles/sandboxwebsite/frontend/js/imagesloaded.pkgd.min.js') }}"></script>

<script src="{{ asset('bundles/sandboxwebsite/frontend/js/translations.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/func.js') }}"></script>
<script src="{{ asset('bundles/sandboxwebsite/frontend/js/travelbase.js') }}"></script>

<script>
    $(function () {
        $('[data-toggle="popover"]').popover();
    })
</script>